<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Meal-Based Calorie Counting Game</title>
    <style>
      body {
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background-color: #fff0f5;
        font-family: Arial, sans-serif;
      }
      .game-container {
        width: 800px;
        height: 600px;
        position: relative;
        overflow: hidden;
        background: linear-gradient(to bottom, #87ceeb, #e0ffff);
        border: 2px solid #333;
      }
      .food,
      .catcher {
        position: absolute;
      }
      .food {
        padding: 5px;
        background-color: rgba(255, 255, 255, 0.7);
        border-radius: 10px;
        font-size: 12px;
        text-align: center;
        transition: transform 0.3s;
      }
      .catcher {
        width: 60px;
        height: 60px;
        background-color: #8b4513;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        font-weight: bold;
      }
      .score,
      .calorie-count {
        position: absolute;
        top: 10px;
        font-size: 18px;
        color: #333;
      }
      .score {
        left: 10px;
      }
      .calorie-count {
        right: 10px;
      }
      .floating-text {
        position: absolute;
        font-size: 16px;
        font-weight: bold;
        opacity: 0;
        transition: transform 0.5s, opacity 0.5s;
      }
      @keyframes float-up {
        0% {
          transform: translateY(0);
          opacity: 1;
        }
        100% {
          transform: translateY(-50px);
          opacity: 0;
        }
      }
      .plate {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 80px;
        background-color: #f5deb3;
        display: flex;
        align-items: center;
        padding: 0 10px;
        overflow-x: auto;
        white-space: nowrap;
      }
      .plate-item {
        display: inline-block;
        margin-right: 10px;
        padding: 5px;
        background-color: rgba(255, 255, 255, 0.7);
        border-radius: 5px;
        font-size: 12px;
      }
      .game-over,
      .meal-selection {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
      }
      .meal-selection button,
      .game-over button {
        margin: 10px;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="game-container">
      <div class="score">Score: <span id="score">0</span></div>
      <div class="calorie-count">
        Calories: <span id="calories">0</span> /
        <span id="calorieLimit">0</span>
      </div>
      <div class="catcher">Fork</div>
      <div class="plate" id="plate"></div>
      <div class="meal-selection" id="mealSelection">
        <h2>Select a Meal</h2>
        <button onclick="startGame('breakfast')">Breakfast</button>
        <button onclick="startGame('lunch')">Lunch</button>
        <button onclick="startGame('dinner')">Dinner</button>
      </div>
      <div class="game-over" id="gameOver" style="display: none">
        <h2>Game Over!</h2>
        <p>You've reached the calorie limit!</p>
        <button onclick="showMealSelection()">Play Again</button>
      </div>
    </div>

    <script>
      const gameContainer = document.querySelector(".game-container");
      const catcher = document.querySelector(".catcher");
      const scoreElement = document.getElementById("score");
      const calorieElement = document.getElementById("calories");
      const calorieLimitElement = document.getElementById("calorieLimit");
      const plateElement = document.getElementById("plate");
      const gameOverElement = document.getElementById("gameOver");
      const mealSelectionElement = document.getElementById("mealSelection");
      let score = 0;
      let totalCalories = 0;
      let CALORIE_LIMIT = 0;
      let currentFoodItems = [];

      const mealOptions = {
        breakfast: {
          calorieLimit: 500,
          foods: [
            { name: "Oatmeal", category: "Good", score: 5, calories: 150 },
            { name: "Greek Yogurt", category: "Good", score: 4, calories: 100 },
            { name: "Banana", category: "Good", score: 3, calories: 105 },
            {
              name: "Whole Grain Toast",
              category: "Good",
              score: 4,
              calories: 70,
            },
            { name: "Eggs", category: "Good", score: 4, calories: 140 },
            { name: "Bacon", category: "Bad", score: -3, calories: 180 },
            {
              name: "Sugary Cereal",
              category: "Bad",
              score: -4,
              calories: 200,
            },
            { name: "Doughnut", category: "Bad", score: -5, calories: 250 },
          ],
        },
        lunch: {
          calorieLimit: 700,
          foods: [
            {
              name: "Grilled Chicken",
              category: "Good",
              score: 5,
              calories: 200,
            },
            { name: "Salad", category: "Good", score: 5, calories: 50 },
            { name: "Brown Rice", category: "Good", score: 4, calories: 150 },
            { name: "Apple", category: "Good", score: 4, calories: 95 },
            { name: "Sandwich", category: "Neutral", score: 2, calories: 300 },
            { name: "French Fries", category: "Bad", score: -4, calories: 250 },
            { name: "Soda", category: "Bad", score: -5, calories: 150 },
            { name: "Chips", category: "Bad", score: -3, calories: 160 },
          ],
        },
        dinner: {
          calorieLimit: 800,
          foods: [
            { name: "Salmon", category: "Good", score: 5, calories: 250 },
            {
              name: "Steamed Vegetables",
              category: "Good",
              score: 5,
              calories: 50,
            },
            { name: "Sweet Potato", category: "Good", score: 4, calories: 100 },
            { name: "Lean Steak", category: "Good", score: 4, calories: 300 },
            { name: "Pasta", category: "Neutral", score: 2, calories: 200 },
            { name: "Pizza", category: "Bad", score: -4, calories: 300 },
            { name: "Ice Cream", category: "Bad", score: -3, calories: 200 },
            {
              name: "Fried Chicken",
              category: "Bad",
              score: -5,
              calories: 400,
            },
          ],
        },
      };

      function startGame(meal) {
        mealSelectionElement.style.display = "none";
        CALORIE_LIMIT = mealOptions[meal].calorieLimit;
        currentFoodItems = mealOptions[meal].foods;
        calorieLimitElement.textContent = CALORIE_LIMIT;
        resetGame();
        gameContainer.style.cursor = "none";
        for (let i = 0; i < 5; i++) {
          createFood();
        }
      }

      function createFood() {
        const food = document.createElement("div");
        food.className = "food";
        const randomFood =
          currentFoodItems[Math.floor(Math.random() * currentFoodItems.length)];
        food.textContent = randomFood.name;
        food.dataset.category = randomFood.category;
        food.dataset.score = randomFood.score;
        food.dataset.calories = randomFood.calories;
        food.style.left = `${
          Math.random() * (gameContainer.offsetWidth - 100)
        }px`;
        food.style.top = `${
          Math.random() * (gameContainer.offsetHeight - 150)
        }px`;
        gameContainer.appendChild(food);

        const speed = Math.random() * 2 + 1;
        const angle = Math.random() * Math.PI * 2;
        let vx = Math.cos(angle) * speed;
        let vy = Math.sin(angle) * speed;

        function moveFood() {
          let x = parseFloat(food.style.left);
          let y = parseFloat(food.style.top);
          x += vx;
          y += vy;

          if (x < 0 || x > gameContainer.offsetWidth - food.offsetWidth)
            vx *= -1;
          if (y < 0 || y > gameContainer.offsetHeight - food.offsetHeight - 80)
            vy *= -1;

          food.style.left = `${x}px`;
          food.style.top = `${y}px`;

          if (isColliding(catcher, food)) {
            catchFood(food);
          } else {
            requestAnimationFrame(moveFood);
          }
        }

        moveFood();
      }

      function isColliding(catcher, food) {
        const catcherRect = catcher.getBoundingClientRect();
        const foodRect = food.getBoundingClientRect();
        return !(
          catcherRect.right < foodRect.left ||
          catcherRect.left > foodRect.right ||
          catcherRect.bottom < foodRect.top ||
          catcherRect.top > foodRect.bottom
        );
      }

      function catchFood(food) {
        const scoreChange = parseInt(food.dataset.score);
        const calories = parseInt(food.dataset.calories);
        score += scoreChange;
        totalCalories += calories;
        scoreElement.textContent = score;
        calorieElement.textContent = totalCalories;

        catcher.style.backgroundColor =
          food.dataset.category === "Good" ? "#4CAF50" : "#FF5733";
        setTimeout(() => (catcher.style.backgroundColor = "#8B4513"), 300);

        const plateItem = document.createElement("div");
        plateItem.className = "plate-item";
        plateItem.textContent = `${food.textContent} (${calories} cal)`;
        plateElement.appendChild(plateItem);

        const floatingText = document.createElement("div");
        floatingText.className = "floating-text";
        floatingText.textContent = `${
          scoreChange > 0 ? "+" : ""
        }${scoreChange} (${calories} cal)`;
        floatingText.style.color = scoreChange > 0 ? "#4CAF50" : "#FF5733";
        floatingText.style.left = food.style.left;
        floatingText.style.top = food.style.top;
        gameContainer.appendChild(floatingText);

        setTimeout(() => {
          floatingText.style.animation = "float-up 0.5s forwards";
          setTimeout(() => floatingText.remove(), 500);
        }, 0);

        food.remove();
        if (totalCalories >= CALORIE_LIMIT) {
          endGame();
        } else {
          createFood();
        }
      }

      function updateCatcherPosition(e) {
        const rect = gameContainer.getBoundingClientRect();
        let x, y;
        if (e.type === "touchmove") {
          x = e.touches[0].clientX - rect.left;
          y = e.touches[0].clientY - rect.top;
        } else {
          x = e.clientX - rect.left;
          y = e.clientY - rect.top;
        }
        x = Math.max(
          0,
          Math.min(
            x - catcher.offsetWidth / 2,
            rect.width - catcher.offsetWidth
          )
        );
        y = Math.max(
          0,
          Math.min(
            y - catcher.offsetHeight / 2,
            rect.height - catcher.offsetHeight - 80
          )
        );
        catcher.style.left = `${x}px`;
        catcher.style.top = `${y}px`;
      }

      function endGame() {
        gameOverElement.style.display = "block";
        gameContainer.style.cursor = "default";
        gameContainer.removeEventListener("mousemove", updateCatcherPosition);
        gameContainer.removeEventListener("touchmove", updateCatcherPosition);
      }

      function resetGame() {
        score = 0;
        totalCalories = 0;
        scoreElement.textContent = score;
        calorieElement.textContent = totalCalories;
        plateElement.innerHTML = "";
        gameOverElement.style.display = "none";
        document.querySelectorAll(".food").forEach((food) => food.remove());
        gameContainer.addEventListener("mousemove", updateCatcherPosition);
        gameContainer.addEventListener("touchmove", updateCatcherPosition, {
          passive: false,
        });
      }

      function showMealSelection() {
        mealSelectionElement.style.display = "block";
        gameOverElement.style.display = "none";
        resetGame();
      }

      gameContainer.addEventListener("mousemove", updateCatcherPosition);
      gameContainer.addEventListener(
        "touchmove",
        (e) => {
          e.preventDefault();
          updateCatcherPosition(e);
        },
        { passive: false }
      );

      gameContainer.addEventListener("mouseenter", updateCatcherPosition);

      showMealSelection();
    </script>
  </body>
</html>
